---
layout: post
title: "导出csv文件用excel打开出现提示框"
date: 2015-02-09 13:39:00
description: 项目中导出csv文件遇到的小问题
headline:
category: others
tags: [ export csv ]
comments: true
mathjax:
---
###问题描述


今天台湾的测试发现一个问题，项目导出数据保存为csv文件的时候，用excel打开会出现提示:


>“档案格式与副档名不相符，此档案可能已损毁或不安全，除非您信任此档案的来源，否则请勿开启此档案。您仍要开启此档案吗？”


###问题原因


由于保存的数据的表头是可以在项目配置页面配置的，比如mongodb中的“_id”字段被配置成了“ID”， 并且这个字段在数据中是第一列，这就造成了这么一个现象:


>csv的开头前两个字符为大写字母“ID”， excel会默认认为当前打开的是个SYLK文件。


这当然就不对啦，因为明明打开的是”.csv“文件。


###解决方案


只要将前两个字符改成不是”ID“就行啦，比如小写的“id”或者其他的，再或者将id列挪到后面一点就好啦。


###小科普


STLK文件是Microsoft Excel的数据导入格式文件，以SYLK文件格式保存的文件，文件后缀名为".slk"。
